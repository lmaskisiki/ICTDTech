package infosource.health.ematclinic.services;

import infosource.health.mms.models.Checkup;

import java.util.Collection;
import java.util.List;

import javax.inject.Singleton;
import javax.persistence.EntityManager;
import javax.persistence.Persistence;
import javax.persistence.PersistenceContext;
import javax.transaction.Transactional;

import org.ops4j.pax.cdi.api.OsgiServiceProvider;

@Transactional
@Singleton
@OsgiServiceProvider(classes={ ICheckupService.class})
public class CheckupService implements ICheckupService {
	
	@PersistenceContext(unitName="mms")
	EntityManager em;
public CheckupService() {}


	public Checkup addCheckup(Checkup checkup) {
		em.persist(checkup);
		return null;
	}

	public Collection<Checkup> getCheckups() {
		Collection<Checkup> checkupList = em.createQuery(
				"SELECT e FROM Checkup e").getResultList();
		return checkupList;
	}

	public Checkup getCheckupById(int key) {
		Checkup checkup = null;
		em.getTransaction().begin();
		checkup = em.find(Checkup.class, key);
		em.getTransaction().commit();
		return checkup;
	}

	public List<Checkup> getCheckups(int maternalId) {
		List<Checkup> checkupList = em.createQuery(
				"SELECT e FROM e WHERE e.mid ='" + maternalId + "'")
				.getResultList();
		return checkupList;
	}
}
